<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sng.gdrs.model.dao.IUserInfoDao">
<!-- 	로그인 -->
	<select id="umLogin" parameterType="java.util.Map" resultType="UserInfoDto">
		SELECT EMAIL
      	  FROM USERINFO u 
      	  WHERE EMAIL =#{email}
              AND PASSWORD =#{password}
              AND DELFLAG ='N'
              AND EMAILCHECK = 'Y'
	</select>

<!-- 회원가입 -->
	<insert id="umSignUp" parameterType="UserInfoDto">
		INSERT INTO USERINFO (
                           EMAIL, PASSWORD, NAME, 
                           BIRTH, PHONE)
        VALUES(#{email}, #{password}, #{name},
                        #{birth}, #{phone})
	</insert>

<!-- 이메일 중복검사 -->
	<select id="umDuplicate" parameterType="java.lang.String" resultType="java.lang.Integer">
		SELECT COUNT(EMAIL)
       	 FROM USERINFO u 
       	 WHERE EMAIL = #{email}
	</select>

<!-- 이메일 인증. -->
	<update id="umConfirm" parameterType="java.util.Map">
		UPDATE USERINFO SET EMAILCHECK = 'Y'
       	 WHERE EMAIL =  #{email}
	</update>

<!-- 내정보확인 -->
	<select id="umMyPage" parameterType="java.lang.String" resultType="UserInfoDto">
		SELECT EMAIL, NAME, BIRTH ,PHONE
      	  FROM USERINFO u 
       	 WHERE EMAIL = #{email}
	</select>

<!-- 내정보 변경 -->
	<update id="umModify" parameterType="java.util.Map">
		UPDATE USERINFO SET PASSWORD =#{password}
     	   WHERE EMAIL = #{email}
              AND PASSWORD = #{password}
	</update>

<!-- 회원탈퇴 -->
	<update id="umDelflag" parameterType="java.util.Map">
		UPDATE USERINFO SET DELFLAG='Y' 
      	  WHERE EMAIL = #{email}
              AND PASSWORD =#{password}
	</update>

<!-- 비밀번호 암호화에 사용될 것 -->
<!-- 아이디로 로그인 -->
	<select id="umEmailSecurity" parameterType="java.lang.String" resultType="UserInfoDto">
		SELECT EMAIL
      	  FROM USERINFO u 
      	  WHERE EMAIL =  #{email}
	</select>

<!-- 비밀번호 확인 -->
	<select id="umPwSecurity" parameterType="java.lang.String" resultType="java.lang.String">
		SELECT PASSWORD 
      	  FROM USERINFO u 
      	  WHERE EMAIL =  #{email}
	</select>

</mapper>